---
title: "Rails ã§ä¸å¤‰ã®å®šæ•°ã‚’å®šç¾©ã™ã‚‹"
emoji: "ğŸ°"
type: "tech"
topics:
  - "rails"
  - "ruby"
published: true
published_at: "2024-02-16 11:41"
---

Rails ã§å®šæ•°ã‚’ä½¿ã„ãŸã‹ã£ãŸã®ã§ã€ä½œæ³•çš„ãªã‚‚ã®ã‚’èª¿ã¹ã¦ã„ãŸã¨ã“ã‚ã€æ›¸ãæ›ãˆã‚’é˜²æ­¢ã™ã‚‹æ©Ÿèƒ½ã‚’è¦‹ã¤ã‘ãŸã®ã§å‚™å¿˜éŒ²ã¨ã—ã¦æ®‹ã—ã¾ã™ã€‚

# ãã‚‚ãã‚‚ã®å®šæ•°ã®ä½¿ã„æ–¹

1. [config gem](https://github.com/rubyconfig/config) ã‚’åˆ©ç”¨ã—ã¦ yml ã§ç®¡ç†ã™ã‚‹
2. `/config/application.rb` ã¨ã‹ `/config/environments/*.rb` ã¨ã‹ã§ç®¡ç†ã™ã‚‹
3. `/config/initializer/constants.rb` ã‚’æ–°è¦ã«ä½œæˆã—ã¦ module ã‚’å®šç¾©ã™ã‚‹
   
ä»–ã«ã‚‚ãƒ¢ãƒ‡ãƒ«ãƒ»ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ©ãƒ¼ã§ã—ã‹åˆ©ç”¨ã—ãªã„å ´åˆã¯ application_controller.rb ãªã©ã§å®šç¾©ã™ã‚‹ãªã©ã®æ–¹æ³•ãŒã‚ã‚Šã¾ã™ã€‚
ä»Šå›ã¯ã€é–¢æ•°ã‚‚åŒæ™‚ã«ç®¡ç†ã—ãŸã‹ã£ãŸã®ã§3ã®æ–¹æ³•ã‚’ä½¿ã†ã“ã¨ã«ã—ã¾ã—ãŸã€‚

**`/config/initializer/constants.rb` ã‚’æ–°è¦ã«ä½œæˆã—ã¦ module ã‚’å®šç¾©ã™ã‚‹**
```ruby
# /config/initializers/constant_parameters.rb
module ConstantParameters 
    AUTHOR = "ndj"
end
```

**å‘¼ã³å‡ºã—æ–¹ã®ä¾‹**
```ruby
# /app/controllers/soregashi_controller.rb
class SoregashiController < ApplicationController

  def author
    render json: {message: "author is #{ConstantParameters.AUTHOR}"}, status: :ok
  end
end
```

# ä¸å¤‰åŒ–ã«ã¯ freeze ã‚’ä½¿ã†
freeze ãƒ¡ã‚½ãƒƒãƒ‰ã¯ Object ã‚¯ãƒ©ã‚¹ã®ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ãƒ¡ã‚½ãƒƒãƒ‰ã§ã™ã€‚
freeze ã•ã‚ŒãŸã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã«å¯¾ã—ã¦ç ´å£Šçš„ãªå¤‰æ›´ã‚’åŠ ãˆã‚ˆã†ã¨ã™ã‚‹ã¨ FrozenError ã®ä¾‹å¤–ã‚’ç™ºç”Ÿã—ã¾ã™ã€‚

**constant_parameters.rb ã§ freeze ã‚’ã—ã¦ãŠã**
```ruby
# /config/initializers/constant_parameters.rb
module ConstantParameters 
    AUTHOR = "ndj"
end

ConstantParameters.freeze
```

**ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã™ã‚‹ã“ã¨ã‚’ç¢ºèªã™ã‚‹**
ä¸‹è¨˜ã‚³ãƒ¼ãƒ‰ã¯ FrozenError ã‚’ç™ºç”Ÿã™ã‚‹ã“ã¨ãŒç¢ºèªã§ãã¾ã™ã€‚

```ruby
# /app/controllers/soregashi_controller.rb
class SoregashiController < ApplicationController

  def author
    ConstantParameters.AUTHOR = "ndjndj" # ã“ã“ã§ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã™ã‚‹ã€‚
    render json: {message: "author is #{ConstantParameters.AUTHOR}"}, status: :ok
  end
end
```

# ã•ã„ã”ã«
ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã™ã‚‹ãªã‚‰äº‹å‰ã«æ„å›³ã›ãšå¤‰æ›´ã—ã¦ã—ã¾ã†ã“ã¨ãŒãªã•ãã†ãªã®ã§å®‰å¿ƒã§ã™ã­ã€‚

è‡ªåˆ†ã®ä¸­ã§ã¯å®šæ•°ã¨ã„ãˆã° `UPPER_SNAKE_CASE` ã§ç®¡ç†ã™ã‚‹ã‚¤ãƒ¡ãƒ¼ã‚¸ã—ã‹ãªã‹ã£ãŸã®ã§ã™[^1]ãŒã€ã„ã‚ã„ã‚ãªä»•çµ„ã¿ã‚’çŸ¥ã‚‹ã“ã¨ãŒã§ãã¾ã—ãŸã€‚åˆ©ç”¨ç”¨é€”ã«ã‚ˆã£ã¦ä½¿ã„åˆ†ã‘ãŸã„ã§ã™ã€‚

# å‚è€ƒ
https://docs.ruby-lang.org/ja/latest/method/Object/i/freeze.html
https://qiita.com/takeda-no-nao/items/415107d737c2f35bb244
https://takeda-no-nao.net/programming/ruby/how-to-define-constants/
http://mindia.jp/akikumo_tea/rails-%E5%AE%9A%E6%95%B0

[^1]: Dart ã®æ–‡è„ˆã§ SCREAMING_CAPS ã£ã¦èã„ãŸã“ã¨ã‚ã‚‹ã‘ã©ã€Dart ç‰¹æœ‰ã®å‘¼ã³æ–¹ãªã®ã‹ãªï¼Ÿç¢ºã‹ã«å«ã‚“ã§ã‚‹ã£ã½ã„ãªã¨æ€ã£ãŸè¨˜æ†¶ãŒã‚ã‚‹ã€‚ä»–ã«ã‚‚ snake_case ã¯è›‡ã¿ãŸã„ã ã— CamelCase ã¯ãƒ©ã‚¯ãƒ€ã¿ãŸã„ã ã—ã€kebab-case ã§æ€¥ã«åŠ å·¥å“ã«ãªã‚‹ã®ã‚‚é¢ç™½ã„ã€‚