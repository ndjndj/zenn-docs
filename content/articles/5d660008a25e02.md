---
title: "Postgre SQL ã§æœˆåˆã¨æœˆæœ«ã‚’è¨ˆç®—ã™ã‚‹"
emoji: "ğŸ’½"
type: "tech"
topics:
  - "postgresql"
  - "sql"
published: true
published_at: "2024-03-18 12:47"
---

Postgre SQL ã§é›†è¨ˆå‡¦ç†ã‚’è¡Œã†å‡¦ç†ã‚’å®Ÿè£…ã—ã¦ã„ã¾ã™ã€‚
ä¸ãˆã‚‰ã‚ŒãŸæ—¥ä»˜ã‹ã‚‰æœˆåˆã¨æœˆæœ«ã‚’å–å¾—ã—ãŸã‹ã£ãŸã®ã§ã™ãŒã€SQL Server ã§ã„ã† `EOMONTH` çš„ãªé–¢æ•°ãŒãªã„ã¿ãŸã„ãªã®ã§è‡ªåŠ›ã§è¨ˆç®—ã™ã‚‹å‡¦ç†ã‚’ä½œæˆã—ãŸã®ã§ãã®ãƒ¡ãƒ¢ã§ã™ã€‚

# çµè«–
- æœˆåˆã®å–ã‚Šæ–¹: date_trunc() ã§æœˆåˆã‚’æ±‚ã‚ã‚‹
- æœˆæœ«ã®å–ã‚Šæ–¹: æœˆåˆã‹ã‚‰ä¸€ãƒ¶æœˆå¾Œã‚’æ±‚ã‚ã¦ä¸€æ—¥å¼•ã
- å¹´å§‹ã¨å¹´æœ«ã‚‚ã„ã‘ã‚‹ã‚ˆ

# æœˆåˆã®å–ã‚Šæ–¹: date_trunc() ã§æœˆåˆã‚’æ±‚ã‚ã‚‹
ã¾ãšã¯ã€date_trunc() é–¢æ•°ã‚’ä½¿ç”¨ã—ã¦ã€ä¸ãˆã‚‰ã‚ŒãŸæ—¥ä»˜ã«ã¤ã„ã¦æœˆå˜ä½ã§åˆ‡ã‚Šæ¨ã¦ã‚’è¡Œã„ã¾ã™ã€‚

```sql
SELECT
    CURRENT_TIMESTAMP,
    date_trunc('month', CURRENT_TIMESTAMP) AS bom
-- -> "2024-03-18 03:31:34.712702+00"	"2024-03-01 00:00:00+00"
```

å‚è€ƒ: https://www.postgresql.jp/document/7.2/user/functions-datetime.html

ã“ã‚Œã§æœˆåˆã¯å–å¾—ã™ã‚‹ã“ã¨ãŒã§ãã¾ã—ãŸã€‚

# æœˆæœ«ã®å–ã‚Šæ–¹: æœˆåˆã‹ã‚‰ä¸€ãƒ¶æœˆå¾Œã‚’æ±‚ã‚ã¦ä¸€æ—¥å¼•ã
æ¬¡ã¯æœˆæœ«ã‚’å–ã‚Šã¾ã™ã€‚â†‘ã§å¾—ã‚‰ã‚ŒãŸæœˆåˆã‚’ä½¿ã„ã¾ã™ã€‚æœˆåˆã‹ã‚‰ä¸€ãƒ¶æœˆå¾Œã‚’æ±‚ã‚ã¦ã€ä¸€æ—¥å‰ã«æˆ»ã—ã¾ã™ã€‚

```sql
SELECT
    CURRENT_TIMESTAMP,
    date_trunc('month', CURRENT_TIMESTAMP) AS begining_of_month,
    date_trunc('month', CURRENT_TIMESTAMP) + '1 month' + '-1 day' AS end_of_month
-- -> "2024-03-18 03:35:32.02537+00"	"2024-03-01 00:00:00+00"	"2024-03-31 00:00:00+00"
```

å››å‰‡æ¼”ç®—çš„ã«æ—¥ä»˜ã‚’æ“ä½œã§ãã‚‹ã®ã¯ç›´æ„Ÿçš„ã§ã™ãŒã€æ–‡å­—åˆ—ã§æŒ‡å®šã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚
ã“ã‚Œã§ã€æœˆåˆã¨æœˆæœ«ã‚’å–å¾—ã™ã‚‹ã“ã¨ãŒã§ãã¾ã—ãŸã€‚

# å¹´å§‹ã¨å¹´æœ«ã‚‚ã„ã‘ã‚‹ã‚ˆ
è‚ã¯ date_trunc() é–¢æ•°ã§æœ€åˆã®æ—¥ä»˜ã‚’å–ã‚‹ã“ã¨ã§ã™ã€‚
åˆ‡ã‚Šæ¨ã¦ã®ç¯„å›²ã‚’åºƒã’ã‚Œã°ã€ã“ã®æ–¹æ³•ã§å¹´å§‹ã¨å¹´æœ«ã‚‚å–å¾—ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã­ã€‚

```sql
SELECT
    CURRENT_TIMESTAMP,
    date_trunc('year', CURRENT_TIMESTAMP) AS begin_of_year,
    date_trunc('year', CURRENT_TIMESTAMP) + '1 year' + '-1 day' AS end_of_year
-- -> "2024-03-18 03:40:51.803202+00"	"2024-01-01 00:00:00+00"	"2024-12-31 00:00:00+00"
```

# æœ€å¾Œã«
ã‚ˆãä½¿ã†ã®ã§ FUNCTION ã«ã—ã¦ã‚‚ã„ã„ã‹ã‚‚ã—ã‚Œãªã„ã§ã™ã­

# å‚è€ƒ
https://www.postgresql.jp/document/7.2/user/functions-datetime.html
https://db.just4fun.biz/?PostgreSQL/%E6%9C%88%E6%9C%AB%E3%82%92%E6%B1%82%E3%82%81%E3%82%8B%E6%96%B9%E6%B3%95
