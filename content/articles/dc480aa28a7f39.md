---
title: "ã€SDK åˆ©ç”¨ç·¨ã€‘Rails API Ã— Meilisearch SDK ã‚’ã¤ã‹ã£ã¦ã¿ã‚‹"
emoji: "ğŸ°"
type: "tech"
topics:
  - "docker"
  - "rails"
  - "ruby"
  - "meilisearch"
published: true
published_at: "2024-01-11 20:31"
---

[ã“ã®è¨˜äº‹](https://zenn.dev/ndjndj/articles/1be14c27323294)ã®ç¶šãã§ã™ã€‚

`Rails` ã‚’åˆ©ç”¨ã—ã¦ API ã®é–‹ç™ºã‚’è¡Œã£ã¦ã„ã¾ã™ã€‚
æ¤œç´¢æ©Ÿèƒ½ã‚’ `Meilisearch` ã‚’ç”¨ã„ã¦å®Ÿè£…ã—ãŸã„ã®ã§ã€`meilisearch-rails` gem ã¨ã„ã† `Rails` å‘ã‘ã® `Meilisearch SDK` ã‚’åˆ©ç”¨ã—ã¦ `User` ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã®æ¤œç´¢ãƒ»ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆä½œæˆã‚’ `rails console` ä¸Šã§ç¢ºèªã—ã¾ã™ã€‚

# ç’°å¢ƒæ§‹ç¯‰
ä¸‹è¨˜è¨˜äº‹å†…ã§ã€ãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿ã‚’ä½œæˆã—ã¦ã„ã¾ã™ãŒã€ä½œæˆã—ãªãã¦ã‚‚å¤§ä¸ˆå¤«ã§ã™ã€‚

https://zenn.dev/ndjndj/articles/1be14c27323294

# meilisearch-rails ã«ã¤ã„ã¦
é–“é•ã„ãªã[å…¬å¼](https://github.com/meilisearch/meilisearch-rails)ãŒè©³ã—ã„ã§ã™ã€‚
ã“ã“ã§ã¯ç§ãŒå€‹äººçš„ã«æ³¨ç›®ã—ãŸã„éƒ¨åˆ†ã‚’ç´¹ä»‹ã—ã¾ã™ã€‚

## å‰æ
ã“ã‚“ãªã‹ã‚“ã˜ã®ãƒ¢ãƒ‡ãƒ«ã‚’ä¾‹ã«ã„ã‚ã„ã‚æ›¸ã„ã¦ã„ãã¾ã™ã€‚

```rb
class User < ApplicationRecord
  include MeiliSearch::Rails
  
  # Meilisearch ä¸Šã®ãƒ—ãƒ©ã‚¤ãƒãƒªãƒ¼ã‚­ãƒ¼
  meilisearch primary_key: :id
  
  meilisearch do
    # ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹è¿½åŠ å¯¾è±¡ã¨ãªã‚‹ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰
    attribute :id, :name, :name_ruby, :url
  end
end
```

ãã®ä»– `Meilisearch` ã§ã®ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã«å¯¾å¿œã—ã¦ã„ã¾ã™ã€‚

## è‡ªå‹•ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ä½œæˆ

`RDB` å´ã® `users` ãƒ†ãƒ¼ãƒ–ãƒ«ã®å¤‰æ›´æ™‚ã«ã€è‡ªå‹•çš„ã« `Meilisearch` ã®ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã¨åŒæœŸã—ã¾ã™ã€‚

```ruby
# rails console ã§å®Ÿè¡Œ

# ãƒ¬ã‚³ãƒ¼ãƒ‰ä½œæˆ
User.create(name: "namae", name_ruby: "ãƒŠãƒã‚¨")
# -> RDB users ãƒ†ãƒ¼ãƒ–ãƒ«ã«ãƒ¬ã‚³ãƒ¼ãƒ‰ãŒè¿½åŠ ã•ã‚Œã‚‹
# -> Meilisearch ã«ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆãŒè‡ªå‹•çš„ã«è¿½åŠ ã•ã‚Œã‚‹

# ãƒ¬ã‚³ãƒ¼ãƒ‰å‰Šé™¤
User.find(1).destroy 
# -> RDB users ãƒ†ãƒ¼ãƒ–ãƒ« id = 1 ã®ãƒ¬ã‚³ãƒ¼ãƒ‰ã‚’å‰Šé™¤
# -> Meilisearch ã®å¯¾å¿œã™ã‚‹ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã‚‚è‡ªå‹•çš„ã«å‰Šé™¤ã•ã‚Œã‚‹

# ãƒ¬ã‚³ãƒ¼ãƒ‰æ›´æ–°
user = User.find_by(id: 2)
user.update(name: "updated_name", name_ruby: "updated_name")
# -> RDB users ãƒ†ãƒ¼ãƒ–ãƒ« id = 2 ã®å±æ€§ã‚’æ›´æ–°
# -> Meilisearch ã®å¯¾å¿œã™ã‚‹ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã‚‚è‡ªå‹•çš„ã«æ›´æ–°ã•ã‚Œã‚‹
```

ä»¥å‰ã€`Meilisearch` + `Lambda` ã§æ¤œç´¢æ©Ÿèƒ½ã‚’å®Ÿè£…ã—ã¦ã„ãŸã“ã‚ã¯ DynamoDB Stream ã‚’ã¤ã‹ã£ãŸã‚Šã€ãƒãƒƒãƒå‡¦ç†ã§ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆè¿½åŠ ã‚’ãã‚‹ãã‚‹å›ã—ãŸã‚Šã—ã¦ãªã‹ãªã‹å¤§å¤‰ã ã£ãŸè¨˜æ†¶ãŒã‚ã£ãŸã®ã§ã€ã“ã®æ©Ÿèƒ½ã¯ãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯ãªã‚‰ã§ã¯ã¨ã„ã†æ„Ÿã˜ã§ã‹ãªã‚Šä¾¿åˆ©ã ã¨æ„Ÿã˜ã¾ã—ãŸã€‚

## å¾Œã‹ã‚‰å°å…¥ã—ãŸéš›ã® indexing

æ—¢å­˜ã®ãƒ¢ãƒ‡ãƒ«ã«å¾Œã‹ã‚‰ `Meilisearch` ã‚’å°å…¥ã™ã‚‹éš›ã¯ `reindex!` ãƒ¡ã‚½ãƒƒãƒ‰ã‚’ä½¿ç”¨ã™ã‚‹ã“ã¨ã§ `Meilisearch` ã®ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã‚’ä½œæˆã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚
ã¾ãŸã€å†å®šç¾©ãªã©ã‚’è¡Œã£ãŸå ´åˆã«ã¯ã€ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã®ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã‚’ä¸€åº¦å…¨å‰Šé™¤ã—ã¦å†åº¦ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã‚’ä½œæˆã™ã‚‹ã“ã¨ã‚‚ã§ãã¾ã™ã€‚

```ruby
# rails console ã§å®Ÿè¡Œ
User.clear_index! # ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã®å…¨å‰Šé™¤
User.reindex! # ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ä½œæˆãƒ»ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆè¿½åŠ 
```

## æ¤œç´¢
`meilisearch-rails` ã§ã¯ã€ä»¥ä¸‹ã®ã‚ˆã†ã«æ¤œç´¢ã‚’è¡Œã†ã“ã¨ãŒã§ãã¾ã™ã€‚
`Meilisearch` API ã§æ¤œç´¢ã‚’å®Ÿè¡Œã—ã€ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã‹ã‚‰å¾—ã‚‰ã‚ŒãŸ `primary-key` ã®é…åˆ—ã«ã¤ã„ã¦ `RDB` ä¸Šã®ãƒ†ãƒ¼ãƒ–ãƒ«ã«å¯¾ã—ã¦ `SELECT` ã‚’ã‹ã‘ã‚‹ã¨ã„ã†ãµã†ãªæµã‚Œã§æ¤œç´¢ã‚’å®Ÿè¡Œã—ã¦ã„ã‚‹ã¿ãŸã„ã§ã™ã€‚

:::message

[ã“ã¡ã‚‰](https://github.com/meilisearch/meilisearch-rails/blob/8ed3a5678678be843e21397a77f902a8364fd366/lib/meilisearch-rails.rb#L625)ã‹ã‚‰å®Ÿè£…ã‚’ç¢ºèªã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚

:::

ã¤ã¾ã‚Šã€ä»¥ä¸‹ã®ã‚³ãƒ¼ãƒ‰ã¯ã€
```rb
hits = User.search('æ±äº¬éƒ½')
# => [User, User ...]
```

ä»¥ä¸‹ã®2ã¤ã®ã‚¹ãƒ†ãƒƒãƒ—ã‚’çµŒã¦å¾—ã‚‰ã‚Œã‚‹çµæœã¨ã„ã†ã“ã¨ã«ãªã‚Šã¾ã™ã€‚

```bash
curl \
  -X POST 'http://meilisearch:7700/indexes/User/search' \
  -H 'Content-Type: application/json' \
  -H 'Authorization: Bearer meili-master-key' \
  --data-binary '{ "q": "æ±äº¬éƒ½" }'
```

```sql
SELECT "users".* FROM "users" WHERE "users"."id" IN ($1, $2, $3...) 
```

ã“ã®ã‚ˆã†ãªä»•æ§˜ãŒã‚ã‚‹ãŸã‚ã‹ã©ã†ã‹ã¯ä¸æ˜ã§ã™ãŒã€å…¬å¼ã§ã¯ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã‚µã‚¤ãƒ‰ã‹ã‚‰ã® API åˆ©ç”¨ã‚’æ¨å¥¨ã—ã¦ã„ã¾ã™ã€‚
ç¢ºã‹ã«ã‚ã„ã¾ã„æ¤œç´¢ã®ãƒãƒ¼ãƒ‰ãƒ«ã‚’è¶Šãˆã‚‹ã“ã¨ã¯ã§ããã†ã§ã™ãŒã€`RDB` ã¸ã®å•ã„åˆã‚ã›ã‚’è¡Œã†æ™‚ç‚¹ã§ãã®åˆ†å®Ÿè¡Œæ™‚é–“ã¯å¢—ãˆã‚‹ã®ã§ `Meilisearch` ã®é€Ÿåº¦ã‚’æ´»ã‹ã—ãã‚Œãªã„ã‚ˆã†ãªæ°—ãŒã—ã¾ã™ã€‚
ã¨ã¯ã„ãˆã€`ActiveRecord` ã®ä»•çµ„ã¿ã‚’æ´»ç”¨ã™ã‚‹ã“ã¨ã§ä»–ã® API ã«å€£ã£ãŸå®Ÿè£…ãŒã§ãã‚‹ã“ã¨ã‚„ã€ã‚­ãƒ¼ã‚’éš è”½ã™ã‚‹ã“ã¨ãŒã§ããŸã‚Šã€`Meilisearch` å´ã§ä½™åˆ†ãªãƒ‡ãƒ¼ã‚¿ã‚’æŒãŸãªãã¦ã‚ˆããªã‚‹ã®ã¯ãƒ¡ãƒªãƒƒãƒˆã¨ã„ãˆãã†ã§ã™[^1]ã€‚

ä¸€å¿œ `ms_raw_search` ã‚’ä½¿ãˆã° `Meilisearch` API ã‚’å©ã„ãŸçµæœã®ç”Ÿãƒ‡ãƒ¼ã‚¿ã®ã¿ã‚’å–å¾—ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ãŒã€ãã‚Œã‚’ã™ã‚‹ãã‚‰ã„ãªã‚‰ `Ruby` ç”¨ã® SDK ã‚’ä½¿ã†ã‹ã€ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆå´ã§é ‘å¼µã£ãŸæ–¹ãŒã„ã„ã®ã‹ãªã¨ã€‚

## äº’æ›æ€§
`meilisearch-rails` ã®ãƒ¡ã‚½ãƒƒãƒ‰ã¯ `search`, `index` ãªã©ã®ãƒ¡ã‚½ãƒƒãƒ‰ã‚’æä¾›ã—ã¾ã™ã€‚
ã™ã§ã«ãƒ¢ãƒ‡ãƒ«å´ã§åŒåã®ãƒ¡ã‚½ãƒƒãƒ‰ãŒå®šç¾©ã•ã‚Œã¦ã„ã‚‹å ´åˆã€å†å®šç¾©ã¯ã•ã‚Œã‚‹ã“ã¨ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚
ãƒ¡ã‚½ãƒƒãƒ‰ã®ãƒ—ãƒ¬ãƒ•ã‚£ãƒƒã‚¯ã‚¹ã« `ms_` ã‚’æŒ‡å®šã—ã¦å®Ÿè¡Œã™ã‚‹ã“ã¨ã‚‚ã§ãã¾ã™ã€‚

```rb
hits = User.ms_search('æ±äº¬éƒ½')
# => [User, User ...]
```

# SDK ã‚’è©¦ã—ã¦ã¿ã‚‹

## äº‹å‰æº–å‚™

äº‹å‰æº–å‚™ã¨ã—ã¦ã€ãƒ‡ãƒ¼ã‚¿ã‚’ç”¨æ„ã—ã¾ã™ã€‚
ä»Šå›ã¯å‰å›ã®è¨˜äº‹ã§ã‚‚ä½¿ç”¨ã—ãŸæ¶ç©ºã® `User` ãƒ‡ãƒ¼ã‚¿ã‚’ä½¿ç”¨ã—ã¾ã™ã€‚

### ã¯ã˜ã‚ã‚‹ã¾ãˆã«

[å‰å›ã®è¨˜äº‹](https://zenn.dev/ndjndj/articles/1be14c27323294)ã§ç’°å¢ƒæ§‹ç¯‰ã‚’è¡Œã„ã€ãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿ã¾ã§ä½œæˆã—ã¦ã„ãŸå ´åˆã¯ã€ä¸€åº¦ãã‚Œã„ã«ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã”ã¨å‰Šé™¤ã™ã‚‹ã“ã¨ã‚’ãŠã™ã™ã‚ã—ã¾ã™ã€‚

:::details å‰Šé™¤æ–¹æ³•
```bash
curl \
  -X DELETE 'http://localhost:7700/indexes/{ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹å}' \
  -H 'Authorization: Bearer meili-master-key'
  
# ã‚³ãƒãƒ³ãƒ‰ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆç”¨
curl -X DELETE "http://localhost:7700/indexes/{ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹å}" -H "Authorization: Bearer meili-master-key"
```
:::

### ãƒ¢ãƒ‡ãƒ«ä½œæˆ
`Rails` å´ã§ãƒ¢ãƒ‡ãƒ«ã‚’ä½œæˆã—ã¾ã™ã€‚

```bash
rails g model user
```

è‡ªå‹•ç”Ÿæˆã•ã‚ŒãŸ `db/migrate/yyyymmddxxxxxx_create_user.rb` ã¨ `models/user.rb` ã‚’ãã‚Œãã‚Œè¨˜è¿°ã—ã€`db:migrate` ã—ã¾ã™ã€‚

:::details db/migrate/yyyymmddxxxxxx_create_user.rb
```rb
class CreateUsers < ActiveRecord::Migration[7.1]
  def change
    create_table :users do |t|
      t.string :user_system_id, :null => false, comment: "ãƒ¦ãƒ¼ã‚¶ãƒ¼ID"
      t.string :name, :null => false, comment: "åå‰"
      t.string :name_ruby, comment: "åå‰(ãƒ•ãƒªã‚¬ãƒŠ)"
      t.integer :age, comment: "å¹´é½¢"
      t.string :pref, comment: "éƒ½é“åºœçœŒ"
      t.integer :pref_code, comment: "éƒ½é“åºœçœŒã‚³ãƒ¼ãƒ‰"
      t.string :tel, comment: "é›»è©±ç•ªå·"
      t.string :url, comment: "URL"
      t.timestamps
    end
  end
end
```
:::

:::details models/user.rb
```rb
class User < ApplicationRecord
  include MeiliSearch::Rails

  meilisearch primary_key: :id

  meilisearch do
    attribute :id, :name, :name_ruby, :url
  end
end
```
:::

```bash
rails db:migrate
```

### ãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿ä½œæˆ(RDB)

`db:seed` ã§ãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿ã‚’ä½œæˆã—ã¾ã™ã€‚
æ‰‹å…ƒã«ã‚µãƒ³ãƒ—ãƒ«ãƒ‡ãƒ¼ã‚¿ç”¨ã® `json` ãŒã‚ã‚Œã° `seeds.rb` ã‚’ä»¥ä¸‹ã®ã‚ˆã†ã«æ›¸ãæ›ãˆã¦ `db:seed` ã§ãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿ã‚’ç”Ÿæˆã™ã‚‹ã“ã¨ãŒã§ãã¾ã™(å‚è€ƒè¨˜äº‹: [Qiita Railsã§jsonãƒ•ã‚¡ã‚¤ãƒ«ã®ãƒ‡ãƒ¼ã‚¿ã‚’dbã«å…¥ã‚Œã‚‹](https://qiita.com/wnoonw/items/009daa7e284238e39ff0))ã€‚

ã¡ãªã¿ã«ãƒ¬ã‚³ãƒ¼ãƒ‰æ•°ã¯1000ä»¶ãã‚‰ã„ãŒã¡ã‚‡ã†ã©ã„ã„ã¨æ€ã„ã¾ã™ã€‚å‰å›ã®è¨˜äº‹ã§ä½œæˆã—ãŸãƒ‡ãƒ¼ã‚¿ã‚’10ä¸‡ä»¶ãã®ã¾ã¾ã¶ã‚“å›ã—ãŸã‚‰å½“ç„¶ã®ã‚ˆã†ã«2æ™‚é–“ãã‚‰ã„ã‹ã‹ã‚Šã¾ã—ãŸã€‚

:::details seeds.rb
```rb
user_json = ActiveSupport::JSON.decode(File.read(
  Rails.root.join("db", "sample.json")
))

user_json.each do |d|
  User.create(
    uid: d["user_system_id"],
    name: d["name"],
    name_ruby: d["name_ruby"],
    age: d["age"],
    pref: d["pref"],
    pref_code: d["pref_code"],
    tel: d["tel"],
    url: d["url"]
  )
end
```
:::

```bash
rails db:seed
```

### meilisearch-rails ã®å°å…¥
`meilisearch-rails` gem ã‚’å°å…¥ã—ã¾ã™ã€‚
`Gemfile` ã«ä»¥ä¸‹ã‚’è¿½è¨˜ã—ã¦ `bundle install` ã—ã¾ã™ã€‚

```Gemfile
gem "meilisearch-rails", "~> 0.10.2"
```

```bash
bundle install
```

### Meilisearch ç”¨ã®è¨­å®š
`config/initializers/meilisearch.rb` ã‚’ä½œæˆã™ã‚‹ã‹ä»¥ä¸‹ã®ã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œã—ã¦ `Meilisearch` ç”¨ã®è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½œæˆã—ã¾ã™ã€‚

```bash
rails meilisearch:install
```

ä»¥ä¸‹ã®ã‚ˆã†ã«æ›¸ãæ›ãˆã¾ã™ã€‚

```rb
MeiliSearch::Rails.configuration = {
  meilisearch_url: ENV.fetch('MEILISEARCH_HOST', 'http://meilisearch:7700'), 
  meilisearch_api_key: ENV.fetch('MEILISEARCH_API_KEY', {è¨­å®šã—ãŸ API ã‚­ãƒ¼})
}
```

ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã§ã¯ã€`MEILISEARCH_HOST` ã« `localhost` ã‚’æŒ‡å®šã—ã¦ã„ã¾ã™ãŒã€ `Docker` ã‚’åˆ©ç”¨ã—ã¦ã„ã‚‹å ´åˆã¯ã€ã‚³ãƒ³ãƒ†ãƒŠåã‚’æŒ‡å®šã™ã‚‹å¿…è¦ãŒã‚ã‚‹ã®ã§æ³¨æ„ãŒå¿…è¦ã§ã™ã€‚

### Meilisearch ã«ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã‚’ä½œæˆã™ã‚‹
`rails console` ä¸Šã§æœ€åˆã®ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ä½œæˆã‚’è¡Œã£ã¦ã„ãã¾ã™ã€‚

```bash
rails c
> User.reindex!
```

ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ç”»é¢ã§ã€`RDB` å´ã®ãƒ†ãƒ¼ãƒ–ãƒ«ã®ãƒ¬ã‚³ãƒ¼ãƒ‰æ•°ã¨ `Meilisearch` å´ã®ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã®ãƒ¬ã‚³ãƒ¼ãƒ‰æ•°ãŒä¸€è‡´ã—ã¦ã„ã‚‹ã‹ç¢ºèªã—ã¦ãã ã•ã„ã€‚

![](https://storage.googleapis.com/zenn-user-upload/1fe1e969f4b1-20240111.png)

## ç–é€šç¢ºèª
`rails console` ä¸Šã§ã€æ¤œç´¢ã¨ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã®è‡ªå‹•ä½œæˆãŒã†ã¾ãã„ãã‹ã€è©¦ã—ã¦ã¿ã¾ã™ã€‚

### æ¤œç´¢

```bash
> User.ms_search("ãƒ’ã‚¬ã‚·ã‚¿ãƒ‹")
# => User Load (41.9ms)  SELECT "users".* FROM "users" WHERE "users"."id" IN ($1, $2,...) 
```

### ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã®è‡ªå‹•ä½œæˆ

```bash 
> User.create(user_system_id: "tekiteki", name: "é©å½“ãªåå‰", name_ruby: "tekitonanamae")
# => TRANSACTION (0.3ms)  BEGIN
# => User Create (4.1ms)  INSERT INTO "users" ("user_system_id", "name", ...)
# => TRANSACTION (3.9ms)  COMMIT
> User.ms_search("tekitonanamae")
# => User Load (0.3ms)  SELECT "users".* FROM "users" WHERE "users"."id" = $1...
```

# ã•ã„ã”ã«

API é–‹ç™ºãªã‚‰ã€ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã‹ã‚‰ `Meilisearch` ã® API ã‚’ SDK ã‚’åˆ©ç”¨ã—ã¦å‘¼ã³å‡ºã—ãŸæ–¹ãŒé€Ÿåº¦ã‚‚æ‹…ä¿ã§ãã‚‹ã®ã§ã¯ã¨æ€ã£ãŸãŒã€`Rails` ã® `serializer` ã‚„ `ActiveRecord` ã®ä»•çµ„ã¿ã‚’æ´»ç”¨ã§ãã‚‹ã®ã§ä»–ã® API ã«å€£ã£ãŸå®Ÿè£…ãŒã§ãã‚‹ã“ã¨ã€ã‚­ãƒ¼ã‚’éš è”½ã§ããŸã‚Šã™ã‚‹ã®ã¯ãƒ¡ãƒªãƒƒãƒˆã¨ã„ãˆãã†ã€‚

ãã†ã—ãŸ `Rails` ã®å„ç¨®æ©Ÿèƒ½ãŒä½¿ãˆã‚‹ã“ã¨ + ã‚ã„ã¾ã„æ¤œç´¢ã®æ©Ÿèƒ½å‘ä¸Š + æ¤œç´¢ãƒ­ã‚¸ãƒƒã‚¯ãƒ»ãƒ«ãƒ¼ãƒ«ã‚’ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ã§æŒã¦ã‚‹ã“ã¨ã€ãªã©ã®ãƒ¡ãƒªãƒƒãƒˆã«å¯¾ã—ã¦ã€ `SQL` ã§ã®å•ã„åˆã‚ã›ã«ã‚ˆã‚‹ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ä½ä¸‹ã‚’ã©ã®ãã‚‰ã„è¨±å®¹ã§ãã‚‹ã®ã‹ã¯è€ƒãˆãŸæ–¹ãŒã„ã„ã¨æ€ã†ã€‚

ä¸€æ–¹ã§ã€`meilisearch-rails` ã‚’å°å…¥ã™ã‚‹ã“ã¨ã«ã‚ˆã‚‹ã€`RDB` -> `Meilisearch` ã®ã‚ªãƒ¼ãƒˆã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹æ©Ÿèƒ½ã¯ã‹ãªã‚Šã®ãƒ¡ãƒªãƒƒãƒˆãŒã‚ã‚‹ã¨æ„Ÿã˜ãŸã€‚

`Meilisearch` ã«å…¨ä¹—ã£ã‹ã‚Šã™ã‚‹ãªã‚‰ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã§ã‚‚ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ã§ã‚‚ API ã”ã‚Šã”ã‚Šä½¿ã£ã¦ã„ãã®ã‚‚ã„ã„ã‹ã‚‚ã€‚

æ¬¡å›ã¯ã“ã®ç¶šãã§ã€æ¤œç´¢ API ã¨ãƒ¬ã‚³ãƒ¼ãƒ‰ä½œæˆ API ã‚’ä½œã£ã¦ã„ãã¾ã™ã€‚

# å‚è€ƒ
## Meilisearch é–¢é€£
https://www.meilisearch.com/docs/reference/api/overview
https://zenn.dev/ndjndj/articles/1be14c27323294
https://zenn.dev/ndjndj/articles/c8b6359d2b42b0

## meilisearch-rails é–¢é€£
https://github.com/meilisearch/meilisearch-rails#-getting-started
https://zenn.dev/takeyuwebinc/articles/1a8ba1885c0f4d#meilisearch-rails
https://www.youtube.com/watch?v=pPn-DUqUf1E&t=4s
https://zenn.dev/yagince/articles/7b1e21cf7cc409

## rails db:seed
https://qiita.com/wnoonw/items/009daa7e284238e39ff0

[^1]: ä¸€å¿œã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆå´ã§ã‚­ãƒ¼ã‚’æš—å·åŒ–ã™ã‚‹ãªã©ã®æ–¹æ³•ã‚‚ä¸€å¿œã‚ã‚‹ã‚‰ã—ã„ã€‚ãã‚‚ãã‚‚ã¨ã«ã‹ãéš è”½ã—ãªã„ã¨ã„ã‘ãªã„ã‚‚ã®ã§ã¯ãªã„ã®ã‹ã‚‚ã—ã‚Œãªã„(Google MAP ã® API KEY ã‚‚ç¢ºã‹ãã‚“ãªæ„Ÿã˜ã ã£ãŸæ°—ãŒã™ã‚‹)