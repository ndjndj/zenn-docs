---
title: "Windows11 ã« Docker CE ã‚’å°å…¥ã™ã‚‹"
emoji: "ğŸï¸"
type: "tech"
topics:
  - "docker"
published: true
published_at: "2023-12-25 12:42"
---

`Windows11` ã« `Docker CE` ã‚’å°å…¥ã—ãŸã®ã§å‚™å¿˜éŒ²ã‚’æ®‹ã—ã¾ã™ã€‚

# Docker ã¨ã¯
`Docker` ã¨ã¯ã‚³ãƒ³ãƒ†ãƒŠæŠ€è¡“ã‚’ç”¨ã„ã¦ä»®æƒ³ç’°å¢ƒã‚’é–‹ç™ºãƒ»å®Ÿè¡Œã™ã‚‹ãŸã‚ã®ç®¡ç†ãƒ„ãƒ¼ãƒ«ã§ã™ã€‚
ã‚³ãƒ³ãƒ†ãƒŠæŠ€è¡“ã¨ã¯ã€ãƒ›ã‚¹ãƒˆ OS ä¸Šã§ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®å®Ÿè¡Œç’°å¢ƒã‚’æ§‹ç¯‰ã™ã‚‹æŠ€è¡“ã§ã™ã€‚
ä¸‹è¨˜ã®è¨˜äº‹ãŒã‚ã‹ã‚Šã‚„ã™ã„ã§ã™ã€‚

https://www.fujitsu.com/jp/products/software/resources/feature-stories/cloud/container/
https://knowledge.sakura.ad.jp/13265/
https://zenn.dev/nameless_sn/articles/the_fundamental_of_container
https://qiita.com/satken2/items/10b22bed7a331e425cfe
https://qiita.com/satken2/items/8515900a5a7b9bb0d0c9

ã¨ã„ã†ã‚ã‘ã§ã€`Docker` ã‚’ `Windows` ã«å°å…¥ã—ã¦ã„ããŸã„ã®ã§ã™ãŒã€`Docker Desktop for Windows` ã¯å•†ç”¨åˆ©ç”¨ã™ã‚‹ãŸã‚ã«æœ‰æ–™ã®ã‚µãƒ–ã‚¹ã‚¯ãƒªãƒ—ã‚·ãƒ§ãƒ³ãŒå¿…è¦ã«ãªã‚Šã¾ã™ã€‚
ãªã®ã§ä»Šå›ã¯ `WSL` ã¨ã„ã†ã€`Windows` ç’°å¢ƒå†…ã§ `Linux` ã‚«ãƒ¼ãƒãƒ«ã‚’å®Ÿè¡Œã™ã‚‹ä»•çµ„ã¿ã‚’åˆ©ç”¨ã—ã¦ç„¡å„Ÿç‰ˆã® `Docker CE(Community Edition)` ã‚’å°å…¥ã—ã¾ã™ã€‚

https://docs.docker.jp/desktop/install/windows-install.html

# åˆ©ç”¨ç’°å¢ƒ
- Windows11 pro

# æ‰‹é †
- WSL ã‚’æœ‰åŠ¹ã«ã™ã‚‹
- MicrosoftStore ã‹ã‚‰ Ubuntu ã‚’å…¥æ‰‹ã™ã‚‹
- Ubuntu ã« docker ã‚’å°å…¥ã™ã‚‹


# WSL ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã™ã‚‹
`WSL`(`Windows Subsystem for Linux`) ã¨ã¯ã€`Windows` ã® `OS` ã§ `Linux` å‘ã‘ã®ãƒã‚¤ãƒŠãƒªã‚’å‹•ã‹ã™ãŸã‚ã®ä»•çµ„ã¿ã§ã™ã€‚
`WSL` ã«ã¯ã€ `WSL1` ã¨ `WSL2` ãŒã‚ã‚Šã¾ã™ã€‚

`WSL1` ã¯ `Linux` ã‚«ãƒ¼ãƒãƒ«ã‚’ä½¿ç”¨ã›ãšã€`Linux` ã‚·ã‚¹ãƒ†ãƒ ã‚³ãƒ¼ãƒ«ã‚’ `Windows` API ã«å¤‰æ›ã™ã‚‹ãŸã‚åˆ©ç”¨ã™ã‚‹ã“ã¨ãŒã§ããªã„ã‚½ãƒ•ãƒˆã‚¦ã‚§ã‚¢ãŒå­˜åœ¨ã™ã‚‹å ´åˆã‚‚ã‚ã‚‹ãã†ã§ã™ã€‚
ä¸€æ–¹ã§ã€`WSL2` ã¯ä»®æƒ³ãƒã‚·ãƒ³ä¸Šã«æœ¬ç‰©ã® `Linux` ã‚«ãƒ¼ãƒãƒ«ã‚’å‹•ä½œã•ã›ã‚‹ãŸã‚äº’æ›æ€§ã®å‘ä¸ŠãŒã‚ã£ãŸåé¢ã€ãƒ¡ãƒ¢ãƒªã®æ¶ˆè²»é‡ãŒå¢—åŠ ã—ãŸã‚Šã€èµ·å‹•ã«æ™‚é–“ãŒã‹ã‹ã‚‹ãªã©ã®ãƒ‡ãƒ¡ãƒªãƒƒãƒˆã‚‚ã‚ã‚‹ã‚ˆã†ã§ã™ã€‚

https://ja.wikipedia.org/wiki/Windows_Subsystem_for_Linux

## WSL ã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
ã¾ãšã¯ `WSL` ã‚’ `Windows11` ã«å°å…¥ã—ã¾ã™ã€‚

ã‚³ãƒãƒ³ãƒ‰ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆ(PowerShell ã§ã‚‚å¤§ä¸ˆå¤«ã§ã™)ã§ã€ä»¥ä¸‹ã®ã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œã™ã‚‹ã€‚

```bash
wsl --install
```

å†èµ·å‹•ã‚’æ±‚ã‚ã‚‰ã‚Œã‚‹ã®ã§ã€ä¸€åº¦ `PC` ã‚’å†èµ·å‹•ã—ã¦ãã ã•ã„ã€‚

## WSL2 ã‚’æœ‰åŠ¹ã«ã™ã‚‹
ç¶šã„ã¦ `WSL2` ã‚’æœ‰åŠ¹ã«ã—ã¾ã™ã€‚
ã‚³ãƒãƒ³ãƒ‰ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆ(PowerShell ã§ã‚‚å¤§ä¸ˆå¤«ã§ã™)ã§ã€ä»¥ä¸‹ã®ã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œã™ã‚‹ã€‚

```bash
wsl --set-default-version 2
```

## ãƒãƒ¼ã‚¸ãƒ§ãƒ³ç¢ºèª
ã‚³ãƒãƒ³ãƒ‰ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆ(PowerShell ã§ã‚‚å¤§ä¸ˆå¤«ã§ã™)ã§ã€ä»¥ä¸‹ã®ã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œã™ã‚‹ã€‚
`VERSION` ã®æ¬„ãŒ 2 ã«ãªã£ã¦ã„ã‚Œã°OKã§ã™ã€‚

```bash
wsl -l -v 
#ã¾ãŸã¯
wsl --list --verbose
```

# Ubuntu ã‚’å°å…¥ã™ã‚‹
ç¶šã„ã¦ `Ubuntu` ã‚’ `PC` ã«ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ã¾ã™ã€‚

## MicrosoftStore ã‹ã‚‰ Ubuntu ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã™ã‚‹
`MicrosoftStore` ã‚’é–‹ãã€`Ubuntu` ã¨æ¤œç´¢ã—ã€`Ubuntu 22.04.3` ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ã¾ã™ã€‚
![](https://storage.googleapis.com/zenn-user-upload/e620e73077e7-20231225.png)

## Ubuntu ã«ã¦ä¸€èˆ¬ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚’ä½œæˆã™ã‚‹
ã‚³ãƒãƒ³ãƒ‰ãƒ©ã‚¤ãƒ³ã®ã‚¿ãƒ–ã‹ã‚‰ `Ubuntu` ã‚’é¸æŠã—ã¦é–‹ãã¾ã™ã€‚
![](https://storage.googleapis.com/zenn-user-upload/a07d44d0d062-20231225.png)

ã“ã“ã§ãƒ¦ãƒ¼ã‚¶ãƒ¼åã¨ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã‚’è¨­å®šã™ã‚‹ã‚ˆã†ã«ä¿ƒã•ã‚Œã¾ã™ã®ã§ã€ç”»é¢ã®æŒ‡ç¤ºã«ã—ãŸãŒã£ã¦ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚’ä½œæˆã—ã¦ãã ã•ã„ã€‚

## Ubuntu 22.04 ã‚’ WSL ã®ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã«è¨­å®šã™ã‚‹
ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ãŸ `Ubuntu 22.04` ã‚’ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã«è¨­å®šã—ã¾ã™ã€‚
ã‚³ãƒãƒ³ãƒ‰ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆ(or Windows PowerShell) ã§ã®ä»¥ä¸‹ã‚’å®Ÿè¡Œã—ã¾ã™ã€‚

```bash
wsl --set-default Ubuntu-22.04
```

# Docker ã‚’ Ubuntu ã«ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã™ã‚‹
ã„ã‚ˆã„ã‚ˆã€`Ubuntu` ã« `Docker` ã‚’å°å…¥ã—ã¦ã„ãã¾ã™ã€‚
åŸºæœ¬çš„ã«ã¯ã€[å…¬å¼ã®ã‚¬ã‚¤ãƒ‰](https://docs.docker.com/engine/install/ubuntu/)ã¨[ã“ã¡ã‚‰ã®ã‚¬ã‚¤ãƒ‰](https://dev.to/felipecrs/simply-run-docker-on-wsl2-3o8)ã«æ²¿ã£ã¦å°å…¥ã—ã¦ã„ãã¾ã™ã€‚

## Docker ã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«

```bash
# å¤ã„ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã®å‰Šé™¤
sudo apt-get remove docker docker-engine docker.io containerd runc
# ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã®æ›´æ–°
sudo apt-get update
# é–¢é€£ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
sudo apt-get install ca-certificates curl gnupg lsb-release
# Docker ã® GPG ã‚­ãƒ¼(æš—å·åŒ–ãƒ„ãƒ¼ãƒ«ã®ã‚­ãƒ¼)ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
sudo install -m 0755 -d /etc/apt/keyrings
curl -fsSL https://download.docker.com/linux/ubuntu/gpg | sudo gpg --dearmor -o /etc/apt/keyrings/docker.gpg
sudo chmod a+r /etc/apt/keyrings/docker.gpg

# Docker ã®ãƒªãƒã‚¸ãƒˆãƒªæƒ…å ±ã‚’ apt ã«è¿½åŠ ã—ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã¨ã—ã¦åˆ©ç”¨ã™ã‚‹ã“ã¨ãŒã§ãã‚‹ã‚ˆã†ã«ã™ã‚‹
echo \
  "deb [arch=$(dpkg --print-architecture) signed-by=/etc/apt/keyrings/docker.gpg] https://download.docker.com/linux/ubuntu \
  $(. /etc/os-release && echo "$VERSION_CODENAME") stable" | \
  sudo tee /etc/apt/sources.list.d/docker.list > /dev/null
# ç¢ºèªã¨æ›´æ–°
sudo apt-get update
# Docker CE ã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
sudo apt-get install docker-ce docker-ce-cli containerd.io docker-compose-plugin
```

# Linux ãƒ›ã‚¹ãƒˆãƒã‚·ãƒ³ã®è¨­å®š

## é `root` ãƒ¦ãƒ¼ã‚¶ãƒ¼ã¨ã—ã¦åˆ©ç”¨ã§ãã‚‹ã‚ˆã†ã«è¨­å®šã™ã‚‹

```bash
# docker ã¨ã„ã†ã‚°ãƒ«ãƒ¼ãƒ—ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚’è¿½åŠ ã™ã‚‹
# â€»è‡ªå‹•çš„ã«è¿½åŠ ã•ã‚Œã¦ã„ã‚‹å ´åˆãŒã‚ã‚Šã¾ã™
sudo groupadd docker

# ç¾åœ¨ãƒ­ã‚°ã‚¤ãƒ³ã—ã¦ã„ã‚‹ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚’ docker ã‚°ãƒ«ãƒ¼ãƒ—ã«è¿½åŠ ã™ã‚‹
sudo usermod -aG docker $USER
```

ã“ã“ã¾ã§å®Œäº†ã—ãŸã‚‰å¤‰æ›´ã‚’åæ˜ ã•ã›ã‚‹ãŸã‚ã«ã€ä¸€åº¦ã‚³ãƒãƒ³ãƒ‰ãƒ©ã‚¤ãƒ³ã‚’é–‰ã˜ã¦å†åº¦èµ·å‹•ã—ã¦ãã ã•ã„ã€‚

## WSL èµ·å‹•æ™‚ã« Docker ãŒèµ·å‹•ã™ã‚‹ã‚ˆã†ã«ã™ã‚‹
ã‚³ãƒãƒ³ãƒ‰ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆ(PowerShell ã§ã‚‚å¤§ä¸ˆå¤«ã§ã™)ã§ã€ä»¥ä¸‹ã®ã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œã™ã‚‹ã€‚
`WSL` ãƒãƒ¼ã‚¸ãƒ§ãƒ³ãŒ `0.67.6` ä»¥ä¸Šã§ã‚ã‚Œã° OK ã§ã™ã€‚

```bash
wsl.exe --version
```

ã‚³ãƒãƒ³ãƒ‰ãƒ©ã‚¤ãƒ³ã§ã€`Ubuntu` ã‚’é–‹ãã€ä»¥ä¸‹ã®ã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œã—ã¾ã™ã€‚

```bash
cat /etc/wsl.conf
```
```
[boot] 
systemd=true
```

ä¸Šè¨˜ã®ã‚ˆã†ã«è¡¨ç¤ºã•ã‚Œã‚Œã°å•é¡Œã‚ã‚Šã¾ã›ã‚“ãŒã€ãªã„å ´åˆã¯è¿½è¨˜ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚

```bash
# ã‚¨ãƒ‡ã‚£ã‚¿ã‚’é–‹ã
vi /etc/wsl.conf
# i ã‚­ãƒ¼ã‚’æŠ¼ä¸‹ã—ã¦ INSERT ãƒ¢ãƒ¼ãƒ‰ã‚’èµ·å‹•
# ä¸Šè¨˜ [boot] è¡Œã¨ systemd=true è¡Œã‚’è¿½è¨˜ã™ã‚‹
# esc ã‚­ãƒ¼ã‚’æŠ¼ä¸‹ã—ã¦ INSERT ãƒ¢ãƒ¼ãƒ‰ã‚’çµ‚äº†ã™ã‚‹
# :wq ã¨å…¥åŠ›ã—ã¦ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä¿å­˜ã—ã¦çµ‚äº†ã™ã‚‹
```

# å‚è€ƒ
## Docker
https://www.docker.com/ja-jp/

## Docker ã«ã¤ã„ã¦
https://www.fujitsu.com/jp/products/software/resources/feature-stories/cloud/container/
https://knowledge.sakura.ad.jp/13265/
https://zenn.dev/nameless_sn/articles/the_fundamental_of_container
https://qiita.com/satken2/items/10b22bed7a331e425cfe
https://qiita.com/satken2/items/8515900a5a7b9bb0d0c9

## WSL ã«ã¤ã„ã¦
https://ja.wikipedia.org/wiki/Windows_Subsystem_for_Linux

## Docker å°å…¥æ–¹æ³•ã«ã¤ã„ã¦
https://docs.docker.com/engine/install/ubuntu/
https://dev.to/felipecrs/simply-run-docker-on-wsl2-3o8
https://blog.jp.square-enix.com/iteng-blog/posts/00024-wsl2-docker-ce/


# ã•ã„ã”ã«
ä»Šå›ã€`Docker` ã‚’å°å…¥ã—ãŸç›®çš„ã¯ã€Œ`Dockerfile` ã§ç’°å¢ƒã‚’ç®¡ç†ã™ã‚‹ã“ã¨ã§ã€å„é–‹ç™ºç’°å¢ƒã«ãŠã‘ã‚‹ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã®çµ±ä¸€ãƒ»ç®¡ç†ã‚’æ¥½ã«ã—ãŸã„ã€ã§ã™ã€‚
ä»Šã•ã‚‰è§¦ã£ã¦ã¿ã¾ã—ãŸãŒã‚ã¡ã‚ƒä¾¿åˆ©ã§ã—ãŸã€‚
ã‚†ãã‚†ãã¯æœ¬ç•ªç’°å¢ƒã¸ã®ãƒ‡ãƒ—ãƒ­ã‚¤ã‚„ `AWS Lambda` ã¸ã®ãƒ‡ãƒ—ãƒ­ã‚¤ãªã©ã‚‚è©¦ã—ã¦ã„ããŸã„ã§ã™ã€‚
